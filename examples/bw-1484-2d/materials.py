import openmc
from elements import *
from nuclides import *

###############################################################################
#                 Exporting to OpenMC materials.xml File
###############################################################################

materials = {}

# Instantiate some Materials and register the appropriate Nuclides
materials['UO2'] = openmc.Material(name='2.46% enriched UO2')
materials['UO2'].set_density('sum')
materials['UO2'].add_nuclide(U235, 5.67505E-04, 'ao')
materials['UO2'].add_nuclide(U238, 2.22265E-02, 'ao')
materials['UO2'].add_element(O   , 4.55881E-02, 'ao')

materials['Al 6061'] = openmc.Material(name='Aluminum type 6061')
materials['Al 6061'].set_density('sum')
materials['Al 6061'].add_element(Mg, 5.34873E-04, 'ao')
materials['Al 6061'].add_element(Al, 5.80754E-02, 'ao')
materials['Al 6061'].add_element(Si, 4.63000E-04, 'ao')
materials['Al 6061'].add_element(Cr, 1.09416E-04, 'ao')
materials['Al 6061'].add_element(Mn, 4.43813E-05, 'ao')
materials['Al 6061'].add_element(Fe, 2.03741E-04, 'ao')
materials['Al 6061'].add_element(Cu, 1.02328E-04, 'ao')

materials['B4C'] = openmc.Material(name='B4C for cores II-VIII')
materials['B4C'].set_density('sum')
materials['B4C'].add_element(B, 5.54982E-02, 'ao')
materials['B4C'].add_element(C, 1.33497E-02, 'ao')
materials['B4C'].add_element(O, 3.32183E-05, 'ao')

materials['SS 304'] = openmc.Material(name='304 Stainless Steel')
materials['SS 304'].set_density('sum')
materials['SS 304'].add_element(C , 2.0124E-04, 'ao')
materials['SS 304'].add_element(Mn, 1.4695E-03, 'ao')
materials['SS 304'].add_element(S , 1.5078E-05, 'ao')
materials['SS 304'].add_element(Si, 1.0035E-03, 'ao')
materials['SS 304'].add_element(Cr, 1.6772E-02, 'ao')
materials['SS 304'].add_element(Ni, 6.5966E-03, 'ao')
materials['SS 304'].add_element(Mo, 6.5504E-05, 'ao')
materials['SS 304'].add_element(Cu, 5.3252E-05, 'ao')
materials['SS 304'].add_element(Fe, 6.1838E-02, 'ao')

materials['Gap'] = openmc.Material(name='Helium Gap')
materials['Gap'].set_density('sum')
materials['Gap'].add_nuclide(He4, 0.00024044, 'ao')

# Water materials
materials['Water Core 1'] = openmc.Material(name='Water, 21C for core I')
materials['Water Core 1'].set_density('sum')
materials['Water Core 1'].add_element(H, 6.67232E-02, 'ao')
materials['Water Core 1'].add_element(O, 3.33616E-02, 'ao')

materials['Water Core 2'] = openmc.Material(name='Water, 18.5C with 1037 ppm B for core II')
materials['Water Core 2'].set_density('sum')
materials['Water Core 2'].add_element(H, 6.67572E-02, 'ao')
materials['Water Core 2'].add_element(O, 3.33786E-02, 'ao')
materials['Water Core 2'].add_element(B, 5.78529E-05, 'ao')

materials['Water Core 3'] = openmc.Material(name='Water, 18C with 764 ppm B for core III')
materials['Water Core 3'].set_density('sum')
materials['Water Core 3'].add_element(H, 6.67635E-02, 'ao')
materials['Water Core 3'].add_element(O, 3.33818E-02, 'ao')
materials['Water Core 3'].add_element(B, 4.26266E-05, 'ao')

materials['Water Core 4'] = openmc.Material(name='Water, 17C for core IV')
materials['Water Core 4'].set_density('sum')
materials['Water Core 4'].add_element(H, 6.67755E-02, 'ao')
materials['Water Core 4'].add_element(O, 3.33877E-02, 'ao')

materials['Water Core 5'] = openmc.Material(name='Water, 17.5C for core V')
materials['Water Core 5'].set_density('sum')
materials['Water Core 5'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 5'].add_element(O, 3.33848E-02, 'ao')

materials['Water Core 6'] = openmc.Material(name='Water, 17.5C for core VI')
materials['Water Core 6'].set_density('sum')
materials['Water Core 6'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 6'].add_element(O, 3.33848E-02, 'ao')

materials['Water Core 7'] = openmc.Material(name='Water, 17.5C for core VII')
materials['Water Core 7'].set_density('sum')
materials['Water Core 7'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 7'].add_element(O, 3.33848E-02, 'ao')

materials['Water Core 8'] = openmc.Material(name='Water, 17.5C for core VIII')
materials['Water Core 8'].set_density('sum')
materials['Water Core 8'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 8'].add_element(O, 3.33848E-02, 'ao')

materials['Water Core 9'] = openmc.Material(name='Water, 17.5C for core IX')
materials['Water Core 9'].set_density('sum')
materials['Water Core 9'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 9'].add_element(O, 3.33848E-02, 'ao')

materials['Water Core 10'] = openmc.Material(name='Water, 24.5C with 143 ppm B for core X')
materials['Water Core 10'].set_density('sum')
materials['Water Core 10'].add_element(H, 6.66683E-02, 'ao')
materials['Water Core 10'].add_element(O, 3.33342E-02, 'ao')
materials['Water Core 10'].add_element(B, 7.96720E-06, 'ao')

materials['Water Core 11'] = openmc.Material(name='Water, 26C with 514 ppm B for core XI')
materials['Water Core 11'].set_density('sum')
materials['Water Core 11'].add_element(H, 6.66424E-02, 'ao')
materials['Water Core 11'].add_element(O, 3.33212E-02, 'ao')
materials['Water Core 11'].add_element(B, 2.86260E-05, 'ao')

materials['Water Core 12'] = openmc.Material(name='Water, 26C with 217 ppm B for core XII')
materials['Water Core 12'].set_density('sum')
materials['Water Core 12'].add_element(H, 6.66424E-02, 'ao')
materials['Water Core 12'].add_element(O, 3.33212E-02, 'ao')
materials['Water Core 12'].add_element(B, 1.20820E-05, 'ao')

materials['Water Core 13'] = openmc.Material(name='Water, 20C with 15 ppm B for core XIII')
materials['Water Core 13'].set_density('sum')
materials['Water Core 13'].add_element(H, 6.67373E-02, 'ao')
materials['Water Core 13'].add_element(O, 3.33687E-02, 'ao')
materials['Water Core 13'].add_element(B, 8.36585E-07, 'ao')

materials['Water Core 14'] = openmc.Material(name='Water, 18C with 92 ppm B for core XIV')
materials['Water Core 14'].set_density('sum')
materials['Water Core 14'].add_element(H, 6.67635E-02, 'ao')
materials['Water Core 14'].add_element(O, 3.33813E-02, 'ao')
materials['Water Core 14'].add_element(B, 5.13310E-06, 'ao')

materials['Water Core 15'] = openmc.Material(name='Water, 18C with 395 ppm B for core XV')
materials['Water Core 15'].set_density('sum')
materials['Water Core 15'].add_element(H, 6.67635E-02, 'ao')
materials['Water Core 15'].add_element(O, 3.33818E-02, 'ao')
materials['Water Core 15'].add_element(B, 2.20390E-05, 'ao')

materials['Water Core 16'] = openmc.Material(name='Water, 17.5C with 121 ppm B for core XVI')
materials['Water Core 16'].set_density('sum')
materials['Water Core 16'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 16'].add_element(O, 3.33848E-02, 'ao')
materials['Water Core 16'].add_element(B, 6.75170E-06, 'ao')

materials['Water Core 17'] = openmc.Material(name='Water, 17.5C with 487 ppm B for core XVII')
materials['Water Core 17'].set_density('sum')
materials['Water Core 17'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 17'].add_element(O, 3.33848E-02, 'ao')
materials['Water Core 17'].add_element(B, 2.71740E-05, 'ao')

materials['Water Core 18'] = openmc.Material(name='Water, 18C with 197 ppm B for core XVIII')
materials['Water Core 18'].set_density('sum')
materials['Water Core 18'].add_element(H, 6.67635E-02, 'ao')
materials['Water Core 18'].add_element(O, 3.33818E-02, 'ao')
materials['Water Core 18'].add_element(B, 1.09910E-05, 'ao')

materials['Water Core 19'] = openmc.Material(name='Water, 17.5C with 634 ppm B for core XIX')
materials['Water Core 19'].set_density('sum')
materials['Water Core 19'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 19'].add_element(O, 3.33848E-02, 'ao')
materials['Water Core 19'].add_element(B, 3.53770E-05, 'ao')

materials['Water Core 20'] = openmc.Material(name='Water, 17.5C with 320 ppm B for core XX')
materials['Water Core 20'].set_density('sum')
materials['Water Core 20'].add_element(H, 6.67695E-02, 'ao')
materials['Water Core 20'].add_element(O, 3.33848E-02, 'ao')
materials['Water Core 20'].add_element(B, 1.78560E-05, 'ao')

materials['Water Core 21'] = openmc.Material(name='Water, 16.5C with 72 ppm B for core XXI')
materials['Water Core 21'].set_density('sum')
materials['Water Core 21'].add_element(H, 6.67812E-02, 'ao')
materials['Water Core 21'].add_element(O, 3.33906E-02, 'ao')
materials['Water Core 21'].add_element(B, 4.01830E-06, 'ao')

# Moderator materials
materials['Moderator Core 10'] = openmc.Material(name='Moderator for core X')
materials['Moderator Core 10'].set_density('sum')
materials['Moderator Core 10'].add_element(H, 0.997947*6.66683E-02, 'ao')
materials['Moderator Core 10'].add_element(O, 0.997947*3.33342E-02, 'ao')
materials['Moderator Core 10'].add_element(B, 0.997947*7.96720E-06, 'ao')
materials['Moderator Core 10'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 11'] = openmc.Material(name='Moderator for core XI')
materials['Moderator Core 11'].set_density('sum')
materials['Moderator Core 11'].add_element(H, 0.997947*6.66424E-02, 'ao')
materials['Moderator Core 11'].add_element(O, 0.997947*3.33212E-02, 'ao')
materials['Moderator Core 11'].add_element(B, 0.997947*2.86260E-05, 'ao')
materials['Moderator Core 11'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 12'] = openmc.Material(name='Moderator for core XI')
materials['Moderator Core 12'].set_density('sum')
materials['Moderator Core 12'].add_element(H, 0.997947*6.66424E-02, 'ao')
materials['Moderator Core 12'].add_element(O, 0.997947*3.33212E-02, 'ao')
materials['Moderator Core 12'].add_element(B, 0.997947*1.20820E-05, 'ao')
materials['Moderator Core 12'].add_element(Al, 1.19220E-04, 'ao')

materials['Moderator Core 13'] = openmc.Material(name='Moderator for core XIII')
materials['Moderator Core 13'].set_density('sum')
materials['Moderator Core 13'].add_element(H, 0.997947*6.67373E-02, 'ao')
materials['Moderator Core 13'].add_element(O, 0.997947*3.33687E-02, 'ao')
materials['Moderator Core 13'].add_element(B, 0.997947*8.36585E-07, 'ao')
materials['Moderator Core 13'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 14'] = openmc.Material(name='Moderator for core XIV')
materials['Moderator Core 14'].set_density('sum')
materials['Moderator Core 14'].add_element(H, 0.997947*6.67635E-02, 'ao')
materials['Moderator Core 14'].add_element(O, 0.997947*3.33813E-02, 'ao')
materials['Moderator Core 14'].add_element(B, 0.997947*5.13310E-06, 'ao')
materials['Moderator Core 14'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 15'] = openmc.Material(name='Moderator for core XV')
materials['Moderator Core 15'].set_density('sum')
materials['Moderator Core 15'].add_element(H, 0.997947*6.67635E-02, 'ao')
materials['Moderator Core 15'].add_element(O, 0.997947*3.33818E-02, 'ao')
materials['Moderator Core 15'].add_element(B, 0.997947*2.20390E-05, 'ao')
materials['Moderator Core 15'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 16'] = openmc.Material(name='Moderator for core XVI')
materials['Moderator Core 16'].set_density('sum')
materials['Moderator Core 16'].add_element(H, 0.997947*6.67695E-02, 'ao')
materials['Moderator Core 16'].add_element(O, 0.997947*3.33848E-02, 'ao')
materials['Moderator Core 16'].add_element(B, 0.997947*6.75170E-06, 'ao')
materials['Moderator Core 16'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 17'] = openmc.Material(name='Moderator for core XVII')
materials['Moderator Core 17'].set_density('sum')
materials['Moderator Core 17'].add_element(H, 0.997947*6.67695E-02, 'ao')
materials['Moderator Core 17'].add_element(O, 0.997947*3.33848E-02, 'ao')
materials['Moderator Core 17'].add_element(B, 0.997947*2.71470E-05, 'ao')
materials['Moderator Core 17'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 18'] = openmc.Material(name='Moderator for core XVIII')
materials['Moderator Core 18'].set_density('sum')
materials['Moderator Core 18'].add_element(H, 0.997947*6.67635E-02, 'ao')
materials['Moderator Core 18'].add_element(O, 0.997947*3.33818E-02, 'ao')
materials['Moderator Core 18'].add_element(B, 0.997947*1.09910E-05, 'ao')
materials['Moderator Core 18'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 19'] = openmc.Material(name='Moderator for core XIX')
materials['Moderator Core 19'].set_density('sum')
materials['Moderator Core 19'].add_element(H, 0.997947*6.67695E-02, 'ao')
materials['Moderator Core 19'].add_element(O, 0.997947*3.33848E-02, 'ao')
materials['Moderator Core 19'].add_element(B, 0.997947*3.53770E-05, 'ao')
materials['Moderator Core 19'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 20'] = openmc.Material(name='Moderator for core XX')
materials['Moderator Core 20'].set_density('sum')
materials['Moderator Core 20'].add_element(H, 0.997947*6.67695E-02, 'ao')
materials['Moderator Core 20'].add_element(O, 0.997947*3.33848E-02, 'ao')
materials['Moderator Core 20'].add_element(B, 0.997947*1.78560E-05, 'ao')
materials['Moderator Core 20'].add_element(Al, 1.1922E-04, 'ao')

materials['Moderator Core 21'] = openmc.Material(name='Moderator for core XXI')
materials['Moderator Core 21'].set_density('sum')
materials['Moderator Core 21'].add_element(H, 0.997947*6.67695E-02, 'ao')
materials['Moderator Core 21'].add_element(O, 0.997947*3.33848E-02, 'ao')
materials['Moderator Core 21'].add_element(B, 0.997947*4.01830E-06, 'ao')
materials['Moderator Core 21'].add_element(Al, 1.1922E-04, 'ao')

# Poison plate materials
materials['Poison Plate Core 13'] = openmc.Material(name='Poison plate 5 for core XIII')
materials['Poison Plate Core 13'].set_density('sum')
materials['Poison Plate Core 13'].add_element(B , 2.4368E-03, 'ao')
materials['Poison Plate Core 13'].add_element(Al, 5.9382E-02, 'ao')
materials['Poison Plate Core 13'].add_element(Fe, 4.6005E-05, 'ao')
materials['Poison Plate Core 13'].add_element(Si, 3.4304E-05, 'ao')

materials['Poison Plate Core 14'] = openmc.Material(name='Poison plate 4 for core XIV')
materials['Poison Plate Core 14'].set_density('sum')
materials['Poison Plate Core 14'].add_element(B , 1.8978E-03, 'ao')
materials['Poison Plate Core 14'].add_element(Al, 5.9598E-02, 'ao')
materials['Poison Plate Core 14'].add_element(Fe, 4.6172E-05, 'ao')
materials['Poison Plate Core 14'].add_element(Si, 3.4429E-05, 'ao')

materials['Poison Plate Core 15'] = openmc.Material(name='Poison plate 3 for cores XV')
materials['Poison Plate Core 15'].set_density('sum')
materials['Poison Plate Core 15'].add_element(B , 6.0543E-04, 'ao')
materials['Poison Plate Core 15'].add_element(Al, 6.0115E-02, 'ao')
materials['Poison Plate Core 15'].add_element(Fe, 4.6572E-05, 'ao')
materials['Poison Plate Core 15'].add_element(Si, 3.4727E-05, 'ao')

materials['Poison Plate Core 16'] = openmc.Material(name='Poison plate 3 for cores XVI')
materials['Poison Plate Core 16'].set_density('sum')
materials['Poison Plate Core 16'].add_element(B , 6.0543E-04, 'ao')
materials['Poison Plate Core 16'].add_element(Al, 6.0115E-02, 'ao')
materials['Poison Plate Core 16'].add_element(Fe, 4.6572E-05, 'ao')
materials['Poison Plate Core 16'].add_element(Si, 3.4727E-05, 'ao')

materials['Poison Plate Core 17'] = openmc.Material(name='Poison plate 2 for cores XVII')
materials['Poison Plate Core 17'].set_density('sum')
materials['Poison Plate Core 17'].add_element(B , 3.6537E-04, 'ao')
materials['Poison Plate Core 17'].add_element(Al, 6.0211E-02, 'ao')
materials['Poison Plate Core 17'].add_element(Fe, 4.6646E-05, 'ao')
materials['Poison Plate Core 17'].add_element(Si, 3.4783E-05, 'ao')

materials['Poison Plate Core 18'] = openmc.Material(name='Poison plate 2 for cores XVIII')
materials['Poison Plate Core 18'].set_density('sum')
materials['Poison Plate Core 18'].add_element(B , 3.6537E-04, 'ao')
materials['Poison Plate Core 18'].add_element(Al, 6.0211E-02, 'ao')
materials['Poison Plate Core 18'].add_element(Fe, 4.6646E-05, 'ao')
materials['Poison Plate Core 18'].add_element(Si, 3.4783E-05, 'ao')

materials['Poison Plate Core 19'] = openmc.Material(name='Poison plate 1 for cores XIX')
materials['Poison Plate Core 19'].set_density('sum')
materials['Poison Plate Core 19'].add_element(B , 1.5098E-04, 'ao')
materials['Poison Plate Core 19'].add_element(Al, 6.0296E-02, 'ao')
materials['Poison Plate Core 19'].add_element(Fe, 4.6713E-05, 'ao')
materials['Poison Plate Core 19'].add_element(Si, 3.4832E-05, 'ao')

materials['Poison Plate Core 20'] = openmc.Material(name='Poison plate 1 for cores XX')
materials['Poison Plate Core 20'].set_density('sum')
materials['Poison Plate Core 20'].add_element(B , 1.5098E-04, 'ao')
materials['Poison Plate Core 20'].add_element(Al, 6.0296E-02, 'ao')
materials['Poison Plate Core 20'].add_element(Fe, 4.6713E-05, 'ao')
materials['Poison Plate Core 20'].add_element(Si, 3.4832E-05, 'ao')

materials['Poison Plate Core 21'] = openmc.Material(name='Poison plate 1 for cores XXI')
materials['Poison Plate Core 21'].set_density('sum')
materials['Poison Plate Core 21'].add_element(B , 1.5098E-04, 'ao')
materials['Poison Plate Core 21'].add_element(Al, 6.0296E-02, 'ao')
materials['Poison Plate Core 21'].add_element(Fe, 4.6713E-05, 'ao')
materials['Poison Plate Core 21'].add_element(Si, 3.4832E-05, 'ao')

materials_file = openmc.MaterialsFile()
materials_file.default_xs = '71c'
materials_file.add_materials(materials.values())
materials_file.export_to_xml()
